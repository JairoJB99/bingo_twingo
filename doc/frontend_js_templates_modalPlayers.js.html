<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: frontend/js/templates/modalPlayers.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: frontend/js/templates/modalPlayers.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { app } from '../../main.js';
import {clearModal, showModal } from '../core';
import '../../css/modalPlayers.css';
import * as utils from '../utils.js'
//import * as settings from '../../utils/settings.json'
let settings = require('../../../settings')
import { modalMainMenu } from './modalMainMenu';
/**
* It's a function that when any player win the bingo  there is a background audio that sings bingo!!
* This function I'll  imported it into index and called it in  pubSub.subscribe("BINGO")
*/

export const modalPlayers = () => {

    const controllers = () => {
        let playersNames = JSON.parse(localStorage.getItem('playersNames')) || [];
        clearModal("gameLayout") //clear the game
        // Draw the players in localStorage. Each time you add or delete a player, this function is called.
        function renderPlayerList() {
            playersNames = JSON.parse(localStorage.getItem('playersNames')) || [];
            let uList = document.getElementById("listPlayers");
            // Delete all palyers before drawing them again
            uList.innerHTML = '';
            // Draw all current players
            playersNames.forEach((name, index) => {
                let li = document.createElement('li');
                li.setAttribute("id", "player_" + name);
                li.innerHTML = `&lt;div>&lt;span class='players'>${index + 1}&lt;/span>&lt;p>${name}&lt;/p>&lt;/div>&lt;span class="removePlayer">&amp;times;&lt;/span>`;
                li.addEventListener('click', (event) => {
                    let name = li.id.replace('player_', '');
                    playersNames = playersNames.filter((item) => item != name);
                    localStorage.setItem('playersNames', JSON.stringify(playersNames));
                    renderPlayerList();
                })
                uList.appendChild(li);
            });
            document.getElementById('remainingPlayersSpan').innerHTML = "Players: "+playersNames.length + "/50 "; // At the moment the max players are static
        }

        /*
        * First add the current players in localstorage. Then, if you hit the
        * add player button you can add more. You can also delete them
        * by clicking in their names
        */
        let addButton = document.getElementById('addplayer');

        renderPlayerList();

        addButton.onclick = function () {
            let playerName = document.getElementById("fname").value;
            if (playerName) { //If input name is empty
                if (!playersNames.includes(playerName)) { //If name is repeated
                    if (utils.checkName(playerName)) { //If name is not allowed
                        if (window.localStorage) { //Check if the navigator supports localstorage
                            document.getElementById('msg--err').innerHTML = "";
                            playersNames.push(document.getElementById("fname").value);
                            localStorage.setItem('playersNames', JSON.stringify(playersNames));
                            document.getElementById("fname").value = null;
                            renderPlayerList(); //Render players list again
                        }
                    } else document.getElementById('msg--err').innerHTML = "\u26A0  Name not allowed!"
                } else document.getElementById('msg--err').innerHTML = "\u26A0  You cannot introduce repeated names!"
            } else document.getElementById('msg--err').innerHTML = "\u26A0  Enter the player's name!"
        }


        
        /**
         * Add player on press enter key
         */
        document.getElementById("fname").addEventListener("keyup", function (event) { //Add player pressing enter in input
            if (event.keyCode === 13) {
                event.preventDefault();
                document.getElementById("addplayer").click();
            }
        });
      
        /**
         * Here you have the set interval  time options
         */
        let inputVal = document.querySelector('#spinner__value');
        //set default from settings
        inputVal.value= settings.ballspeed;
        let btnUp = document.querySelector('#spinner__up');
        let btnDown = document.querySelector('#spinner__down');

        btnUp.onclick = function () {
            let value = parseFloat(inputVal.value);
            if (value &lt; 5.0) inputVal.value = (value + parseFloat(0.1)).toFixed(1);
        };

        btnDown.onclick = function () {
            let value = parseFloat(inputVal.value);
            if (value > 0.1) inputVal.value = (value - parseFloat(0.1)).toFixed(1);
        };

        inputVal.addEventListener('change', (event) => {
            if (event.target.value &lt;= 0) event.target.value = 0.1;
            if (event.target.value > 5) event.target.value = 5;
        });
       
     
        /**
         * On click play Button, game starts.
         */
        
        let playBtn = document.getElementById('playBtn');
        playBtn.onclick = function () {
            if (playersNames.length !== 0 &amp;&amp; playersNames != undefined) { //Check there are players added to the game
                let m = document.getElementById('playersForm');
                m.style.display = "none";
                app.speed = (parseFloat(inputVal.value) * 1000); //SET GAME SPEED
                app.start();
            } else {
                document.getElementById('msg--err').innerHTML = "\u26A0  Add some players first!"
            }

        
        }
        //rback button
        let back = document.getElementById('back_button');
        back.onclick = () =>{
            showModal(modalMainMenu());
        }
    }

    return {
        template:
            `
            &lt;div id="playersForm" class="modal">
                &lt;!-- Modal content -->
                &lt;div class="modal-content">
                    &lt;h1>BINGO TWINGO&lt;/h1>
                    &lt;button class="menu__start_btn" id="back_button">BACK&lt;/button>
                    &lt;p>&lt;/p>
                    &lt;div class='modal__players__list'>
                        &lt;ol id="listPlayers">&lt;/ol>
                    &lt;/div>
                    &lt;div class="menu__addPlayer">
                        &lt;input type="text" id="fname" name="fname" placeholder="Player name">                                               
                        &lt;i class="far fa-plus-square menu__addPlayer__btn" id='addplayer'>&lt;/i>
                    &lt;/div>
                    &lt;p class="msg--error" id="msg--err">&lt;/p>
                    &lt;div class="menu__options">
                        &lt;button id='playBtn' class="menu__start_btn">START GAME&lt;/button>
                    &lt;/div>
                    &lt;div class="spinner__opts" style="margin-left:10px">
                        &lt;span> Timer: (sec)&lt;/span>
                        &lt;div class="spinner">
                            &lt;button type="button" id="spinner__down" class="spinner__btn spinner__down">&amp;lsaquo;&lt;/button>
                            &lt;input type="number" id="spinner__value" class="spinner__value" name="time" id="match_time" min="0.1" max="5" step="0.1" value="1">
                            &lt;button type="button" id="spinner__up" class="spinner__btn spinner__up">&amp;rsaquo;&lt;/button>
                        &lt;/div>    
                    &lt;/div>
                    &lt;span class="remainingPlayers" id="remainingPlayersSpan">&lt;/span>
                &lt;/div>
            &lt;/div>`,
        controllers: controllers
    }
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="BingoCard.html">BingoCard</a></li><li><a href="Bombo.html">Bombo</a></li></ul><h3>Global</h3><ul><li><a href="global.html#app">app</a></li><li><a href="global.html#checkBingo">checkBingo</a></li><li><a href="global.html#clearModal">clearModal</a></li><li><a href="global.html#debugOption">debugOption</a></li><li><a href="global.html#docReady">docReady</a></li><li><a href="global.html#getBlanks">getBlanks</a></li><li><a href="global.html#getRandomArbitrary">getRandomArbitrary</a></li><li><a href="global.html#imgsBingo">imgsBingo</a></li><li><a href="global.html#modalPlayers">modalPlayers</a></li><li><a href="global.html#randomBingo">randomBingo</a></li><li><a href="global.html#setupAudioBingoWin">setupAudioBingoWin</a></li><li><a href="global.html#setupBackgroundVideo">setupBackgroundVideo</a></li><li><a href="global.html#showModal">showModal</a></li><li><a href="global.html#transpose">transpose</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Thu Dec 03 2020 17:40:56 GMT+0100 (GMT+01:00)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
